import{u as b,a as j,r as o,n as I,b as N,c as D,j as t,d as y,g as C}from"./index-WqMDXwdV.js";const f=({detail:r})=>{const{addItem:m}=b(),{success:i,info:u}=j(),[a,c]=o.useState(1),e=I(r),l=N(e.price),n=Math.max(1,Number(e.stock??9999)),s=a>=1&&a<=n,g=D(e.image||e.imageUrl||r.thumbnail||r.image||"/images/placeholder.jpg");function _(d){const x=Math.max(1,Math.min(n,Number(d)||1));c(x)}function h(){if(!s)return;const d=e.image||e.imageUrl||r.thumbnail||r.image||"",x={...e,thumbnail:d,imageUrl:d};m(x,a),i(`Agregado: ${e.title} √ó ${a}`)}function p(){c(1),u("Cantidad restablecida")}return t.jsxs("section",{className:"ID__wrap",children:[t.jsx("div",{className:"ID__media",children:t.jsx("img",{className:"ID__img",src:g,alt:`Detalle: ${e.title}`,loading:"eager"})}),t.jsxs("div",{className:"ID__info",children:[t.jsxs("h2",{className:"ID__title",children:["üêæ ",e.title]}),e.brand&&t.jsxs("p",{className:"ID__brand",children:["Marca: ",e.brand]}),e.category&&t.jsxs("p",{className:"ID__cat",children:["Categor√≠a: ",e.category]}),e.description&&t.jsx("p",{className:"ID__desc",children:e.description}),t.jsx("div",{className:"ID__price",children:l}),t.jsx("div",{className:"ID__stock",children:Number.isFinite(e.stock)?`Stock: ${e.stock}`:"Stock disponible"}),t.jsxs("div",{className:"ID__actions",children:[t.jsxs("div",{className:"Qty",children:[t.jsx("button",{className:"Qty__btn",type:"button",onClick:()=>_(a-1),"aria-label":"Disminuir cantidad",children:"‚àí"}),t.jsx("input",{className:"Qty__input",type:"number",min:1,max:n,value:a,onChange:d=>_(d.target.value),"aria-label":"Cantidad"}),t.jsx("button",{className:"Qty__btn",type:"button",onClick:()=>_(a+1),"aria-label":"Aumentar cantidad",children:"+"})]}),t.jsx("button",{className:"Btn Btn--primary",type:"button",disabled:!s,onClick:h,children:"Agregar al carrito üêà"}),t.jsx("button",{className:"Btn Btn--ghost",type:"button",onClick:p,children:"Reset"})]})]})]})};function S(){const{id:r}=y(),m=o.useMemo(()=>{try{return decodeURIComponent(String(r))}catch{return String(r)}},[r]),[i,u]=o.useState(null),[a,c]=o.useState("idle"),[e,l]=o.useState(null);return o.useEffect(()=>{if(!m){c("error"),l("ID de producto inv√°lido");return}let n=!0;return c("loading"),l(null),(async()=>{try{const s=await C(m);if(!n)return;if(!s||!s.id){u(null),c("error"),l("Producto no encontrado");return}u(s),c("success")}catch(s){if(!n)return;console.error(s),c("error"),l(s?.message||"Error al cargar el producto")}})(),()=>{n=!1}},[m]),o.useEffect(()=>{const n="Gatilandia üê±",s=i?.name??i?.title;document.title=s?`${n} ¬∑ ${s}`:n},[i]),t.jsxs("main",{className:"IDC",children:[a==="loading"&&t.jsxs("div",{className:"IDC__skeleton",children:[t.jsx("div",{className:"IDC__imgSk"}),t.jsx("div",{className:"IDC__textSk"}),t.jsx("div",{className:"IDC__textSk IDC__textSk--short"})]}),a==="error"&&t.jsxs("p",{className:"IDC__error",role:"alert",children:["‚ùå ",e]}),a==="success"&&i&&t.jsx(f,{detail:i})]})}export{S as default};
